{
  "version": 1,
  "platform": "alptis",
  "slug": "alptis_sante_select_pro_full_hl",
  "name": "Alptis Santé Select – Informations projet (HL)",
  "trace": "retain-on-failure",
  "steps": [
    { "type": "goto", "url": "https://pro.alptis.org/", "label": "accueil" },
    { "type": "waitForField", "field": "login_username", "label": "login-form" },
    { "type": "acceptConsent", "selector": "#axeptio_btn_acceptAll", "label": "accept-axeptio-1" },
    { "type": "fillField", "field": "login_username", "value": "{credentials.username}", "label": "fill-user" },
    { "type": "fillField", "field": "login_password", "value": "{credentials.password}", "label": "fill-pass" },
    { "type": "acceptConsent", "selector": "#axeptio_btn_acceptAll", "label": "accept-axeptio-2" },
    { "type": "sleep", "timeout_ms": 800, "label": "wait-before-submit" },
    { "type": "clickField", "field": "login_submit", "label": "submit" },

    { "type": "goto", "url": "https://pro.alptis.org/sante-select/informations-projet/", "label": "goto-infos-projet" },
    { "type": "sleep", "timeout_ms": 1500, "label": "post-goto-wait" },
    { "type": "acceptConsent", "selector": "#axeptio_overlay #axeptio_btn_acceptAll", "label": "accept-axeptio-page" },
    { "type": "waitForField", "domainField": "project.dateEffet", "label": "infos-projet-ready" },

    { "type": "fillField", "domainField": "project.dateEffet", "leadKey": "project.dateEffet", "label": "fill-date-effet" },
    { "type": "sleep", "timeout_ms": 1500, "label": "wait-after-date-effet" },

    { "type": "clickField", "domainField": "subscriber.civility", "leadKey": "subscriber.civility", "label": "select-civilite" },
    { "type": "sleep", "timeout_ms": 400, "label": "wait-after-civilite" },
    { "type": "fillField", "domainField": "project.dateEffet", "leadKey": "project.dateEffet", "label": "refill-date-effet" },
    { "type": "sleep", "timeout_ms": 500, "label": "wait-after-refill-date" },
    { "type": "fillField", "domainField": "subscriber.lastName", "leadKey": "subscriber.lastName", "label": "fill-nom" },
    { "type": "fillField", "domainField": "subscriber.firstName", "leadKey": "subscriber.firstName", "label": "fill-prenom" },
    { "type": "fillField", "domainField": "subscriber.birthDate", "leadKey": "subscriber.birthDate", "label": "fill-naissance-adherent" },
    { "type": "selectField", "domainField": "subscriber.category", "leadKey": "subscriber.category", "label": "select-categorie-adherent" },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-categorie-adherent" },
    { "type": "clickField", "field": "cadre_exercice_independant", "label": "cadre-exercice-independant", "optional": true },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-cadre-exercice" },
    { "type": "selectField", "domainField": "subscriber.regime", "leadKey": "subscriber.regime", "label": "select-regime-adherent" },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-regime-adherent" },
    { "type": "fillField", "domainField": "subscriber.postalCode", "leadKey": "subscriber.postalCode", "label": "fill-code-postal" },

    { "type": "toggleField", "field": "conjoint_toggle", "label": "toggle-conjoint-oui", "state": "on", "skipIfNot": "spouse" },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-toggle-conjoint", "skipIfNot": "spouse" },
    { "type": "fillField", "domainField": "spouse.birthDate", "leadKey": "spouse.birthDate", "label": "fill-naissance-conjoint", "optional": true },
    { "type": "selectField", "domainField": "spouse.regime", "leadKey": "spouse.regime", "label": "select-regime-conjoint", "optional": true },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-regime-conjoint", "skipIfNot": "spouse.regime" },

    { "type": "toggleField", "field": "enfants_toggle", "label": "toggle-enfants-oui", "state": "on", "skipIfNot": "children" },
    { "type": "waitForField", "field": "enfants_add_button", "label": "wait-add-enfant-visible", "skipIfNot": "children" },

    { "type": "fillField", "domainField": "children[].birthDate", "label": "fill-naissance-enfant-1", "leadKey": "children[0].birthDate", "optional": true },
    { "type": "selectField", "domainField": "children[].regime", "label": "regime-enfant-1", "leadKey": "children[0].regime", "optional": true },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-regime-enfant-1", "skipIfNot": "children[0]" },

    { "type": "clickField", "field": "enfants_add_button", "label": "add-enfant-2", "skipIfNot": "children[1]" },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-add-enfant-2", "skipIfNot": "children[1]" },
    { "type": "fillField", "domainField": "children[].birthDate", "label": "fill-naissance-enfant-2", "leadKey": "children[1].birthDate", "optional": true },
    { "type": "selectField", "domainField": "children[].regime", "label": "regime-enfant-2", "leadKey": "children[1].regime", "optional": true },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-regime-enfant-2", "skipIfNot": "children[1]" },

    { "type": "clickField", "field": "enfants_add_button", "label": "add-enfant-3", "skipIfNot": "children[2]" },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-add-enfant-3", "skipIfNot": "children[2]" },
    { "type": "fillField", "domainField": "children[].birthDate", "label": "fill-naissance-enfant-3", "leadKey": "children[2].birthDate", "optional": true },
    { "type": "selectField", "domainField": "children[].regime", "label": "regime-enfant-3", "leadKey": "children[2].regime", "optional": true },
    { "type": "sleep", "timeout_ms": 300, "label": "wait-after-regime-enfant-3", "skipIfNot": "children[2]" },

    { "type": "sleep", "timeout_ms": 500, "label": "final-wait" }
  ]
}
