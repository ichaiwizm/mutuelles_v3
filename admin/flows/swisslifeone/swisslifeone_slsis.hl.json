{
  "version": 1,
  "platform": "swisslifeone",
  "slug": "swisslifeone_slsis",
  "name": "SwissLifeOne - SLSIS (Tarification & Simulation) HL",
  "trace": "retain-on-failure",
  "steps": [
    { "type": "goto", "url": "https://www.swisslifeone.fr/", "label": "accueil" },
    { "type": "waitForField", "field": "login_button_home", "label": "wait-login-button" },
    { "type": "clickField", "field": "login_button_home", "label": "click-login-button" },
    { "type": "sleep", "timeout_ms": 2000, "label": "wait-sso-load" },
    { "type": "waitForField", "field": "login_username", "label": "wait-sso-form" },
    { "type": "fillField", "field": "login_username", "value": "{credentials.username}", "label": "fill-user" },
    { "type": "fillField", "field": "login_password", "value": "{credentials.password}", "label": "fill-pass" },
    { "type": "clickField", "field": "login_submit", "label": "submit" },
    { "type": "sleep", "timeout_ms": 1500, "label": "wait-post-login" },
    { "type": "clickField", "field": "cookie_tout_autoriser", "label": "accept-cookies", "optional": true },
    { "type": "sleep", "timeout_ms": 1000, "label": "wait-after-cookies" },

    { "type": "goto", "url": "https://www.swisslifeone.fr/index-swisslifeOne.html#/tarification-et-simulation/slsis", "label": "goto-slsis-page" },
    { "type": "sleep", "timeout_ms": 1500, "label": "wait-slsis-load" },

    { "type": "clickField", "field": "cookie_tout_autoriser", "label": "accept-cookies-page", "optional": true },
    { "type": "sleep", "timeout_ms": 1000, "label": "wait-after-cookie" },

    { "type": "enterFrame", "selector": "iframe[name='iFrameTarificateur']", "label": "enter-slsis-iframe", "timeout_ms": 15000 },
    { "type": "sleep", "timeout_ms": 800, "label": "wait-iframe-ready" },

    { "type": "waitForField", "field": "slsis_nom_projet", "label": "wait-nom-projet" },

    { "type": "waitForField", "field": "slsis_date_naissance", "label": "wait-date-naissance" },
    { "type": "typeField", "field": "slsis_date_naissance", "value": "{lead.adherent.date_naissance}", "label": "type-date-naissance", "pressEscape": true, "postDelay_ms": 200 },
    { "type": "waitForNetworkIdle", "label": "network-after-date-naissance" },

    { "type": "waitForField", "field": "slsis_date_effet", "label": "wait-date-effet", "optional": true },
    { "type": "typeField", "field": "slsis_date_effet", "value": "{lead.projet.date_effet}", "label": "type-date-effet", "pressEscape": true, "postDelay_ms": 200, "optional": true },
    { "type": "waitForNetworkIdle", "label": "network-after-date-effet" },

    { "type": "waitForField", "field": "slsis_simulation_individuelle", "label": "wait-simulation-individuelle" },
    { "type": "clickField", "field": "slsis_simulation_individuelle", "label": "click-simulation-individuelle" },
    { "type": "clickField", "field": "slsis_simulation_couple", "label": "click-simulation-couple", "skipIfNot": "conjoint.present" },
    { "type": "waitForNetworkIdle", "label": "network-after-simulation" },

    { "type": "waitForField", "field": "slsis_couverture_oui", "label": "wait-couverture-oui" },
    { "type": "scrollIntoView", "field": "slsis_couverture_oui", "label": "scroll-couverture" },
    { "type": "clickField", "field": "slsis_couverture_oui", "label": "click-couverture-oui" },

    { "type": "waitForField", "field": "slsis_ij_non", "label": "wait-ij-non" },
    { "type": "clickField", "field": "slsis_ij_non", "label": "click-ij-non" },
    { "type": "waitForNetworkIdle", "label": "network-after-couverture" },

    { "type": "selectField", "field": "slsis_departement", "value": "{lead.adherent.departement}", "label": "select-departement" },
    { "type": "selectField", "field": "slsis_regime_social", "value": "{lead.adherent.regime}", "label": "select-regime" },
    { "type": "selectField", "field": "slsis_statut", "value": "{lead.adherent.statut}", "label": "select-statut", "optional": true, "postDelay_ms": 300 },
    { "type": "selectField", "field": "slsis_profession", "value": "{lead.adherent.profession}", "label": "select-profession", "skipIfNot": "adherent.profession", "optional": true },
    { "type": "waitForNetworkIdle", "label": "network-after-identite" },

    { "type": "selectField", "field": "slsis_gamme", "value": "SwissLife Sant√©", "label": "select-gamme" },
    { "type": "waitForNetworkIdle", "label": "network-after-gamme" },

    { "type": "scrollIntoView", "field": "slsis_madelin", "label": "scroll-madelin" },
    { "type": "clickField", "field": "slsis_madelin", "label": "click-madelin" },

    { "type": "waitForField", "field": "slsis_resiliation_non", "label": "wait-resiliation-non", "optional": true },
    { "type": "clickField", "field": "slsis_resiliation_non", "label": "click-resiliation-non", "optional": true },

    { "type": "waitForField", "field": "slsis_reprise_non", "label": "wait-reprise-non", "optional": true },
    { "type": "clickField", "field": "slsis_reprise_non", "label": "click-reprise-non", "optional": true },

    { "type": "exitFrame", "label": "exit-slsis-iframe" }
  ]
}
