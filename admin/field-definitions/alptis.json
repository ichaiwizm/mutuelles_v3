{
  "platform": "alptis",
  "fields": [
    { "key": "login_username", "type": "text", "label": "Nom d’utilisateur", "selector": "#username" },
    { "key": "login_password", "type": "password", "label": "Mot de passe", "selector": "#password" },
    { "key": "login_submit", "type": "button", "label": "Connexion", "selector": "button[type=\"submit\"]" },

    { "key": "date_effet", "type": "text", "label": "Date d’effet", "selector": "#dateEffet input[data-test=\"input\"]" },

    {
      "key": "civilite_adherent",
      "type": "radio-group",
      "label": "Civilité adhérent",
      "options": [
        { "value": "MONSIEUR", "label": "Monsieur", "selector": ".section-adherent span[data-test=\"radio\"][value=\"MONSIEUR\"] label" },
        { "value": "MADAME", "label": "Madame", "selector": ".section-adherent span[data-test=\"radio\"][value=\"MADAME\"] label" }
      ]
    },
    { "key": "nom_adherent", "type": "text", "label": "Nom adhérent", "selector": "#nom" },
    { "key": "prenom_adherent", "type": "text", "label": "Prénom adhérent", "selector": "#prenom" },
    { "key": "date_naissance_adherent", "type": "text", "label": "Date naissance adhérent", "selector": "#date-naissance-adherent input[data-test=\"input\"]" },
    {
      "key": "categorie_adherent",
      "type": "select",
      "label": "Catégorie socio-professionnelle (adhérent)",
      "selector": ".section-adherent .totem-select__input input[placeholder=\"Sélectionner une catégorie socioprofessionnelle\"]",
      "options": {
        "open_selector": ".section-adherent .totem-select__input input[placeholder=\"Sélectionner une catégorie socioprofessionnelle\"]",
        "items": [
          { "value": "AGRICULTEURS_EXPLOITANTS", "label": "Agriculteurs exploitants", "option_selector": ".totem-select-option:has-text('Agriculteurs exploitants')" },
          { "value": "ARTISANS", "label": "Artisans", "option_selector": ".totem-select-option:has-text('Artisans')" },
          { "value": "CADRES", "label": "Cadres", "option_selector": ".totem-select-option .totem-select-option__label:text-is('Cadres')" },
          { "value": "CADRES_EMPLOYES_FONCTION_PUBLIQUE", "label": "Cadres et employés de la fonction publique", "option_selector": ".totem-select-option:has-text('Cadres et employés de la fonction publique')" },
          { "value": "CHEFS_D_ENTREPRISE", "label": "Chefs d'entreprise", "option_selector": ".totem-select-option:has-text(\"Chefs d'entreprise\")" },
          { "value": "COMMERCANTS_ET_ASSIMILES", "label": "Commerçants et assimilés", "option_selector": ".totem-select-option:has-text('Commerçants et assimilés')" },
          { "value": "EMPLOYES", "label": "Employés, agents de maîtrise", "option_selector": ".totem-select-option:has-text('Employés, agents de maîtrise')" },
          { "value": "OUVRIERS", "label": "Ouvriers", "option_selector": ".totem-select-option .totem-select-option__label:text-is('Ouvriers')" },
          { "value": "PERSONNES_SANS_ACTIVITE_PROFESSIONNELLE", "label": "Personnes sans activité professionnelle", "option_selector": ".totem-select-option:has-text('Personnes sans activité professionnelle')" },
          { "value": "PROFESSIONS_LIBERALES_ET_ASSIMILES", "label": "Professions libérales et assimilés", "option_selector": ".totem-select-option:has-text('Professions libérales et assimilés')" },
          { "value": "RETRAITES", "label": "Retraités", "option_selector": ".totem-select-option .totem-select-option__label:text-is('Retraités')" }
        ]
      }
    },
    {
      "key": "regime_adherent",
      "type": "select",
      "label": "Régime obligatoire (adhérent)",
      "selector": ".section-adherent .totem-select__input input[placeholder=\"Sélectionner un régime obligatoire\"]",
      "options": {
        "open_selector": ".section-adherent .totem-select__input input[placeholder=\"Sélectionner un régime obligatoire\"]",
        "items": [
          { "value": "ALSACE_MOSELLE", "label": "Alsace / Moselle", "option_selector": ".totem-select-option:has-text('Alsace / Moselle')" },
          { "value": "AMEXA", "label": "Amexa", "option_selector": ".totem-select-option:has-text('Amexa')" },
          { "value": "REGIME_SALARIES_AGRICOLES", "label": "Régime des salariés agricoles", "option_selector": ".totem-select-option:has-text('Régime des salariés agricoles')" },
          { "value": "SECURITE_SOCIALE", "label": "Sécurité sociale", "option_selector": ".totem-select-option:has-text('Sécurité sociale'):not(:has-text('indépendants'))" },
          { "value": "SECURITE_SOCIALE_INDEPENDANTS", "label": "Sécurité sociale des indépendants", "option_selector": ".totem-select-option:has-text('Sécurité sociale des indépendants')" }
        ]
      }
    },
    { "key": "code_postal", "type": "text", "label": "Code postal", "selector": "input#codePostal" },

    { "key": "cadre_exercice_salarie", "type": "radio", "label": "Cadre d'exercice - Salarié", "selector": "label:has-text('Salarié')" },
    { "key": "cadre_exercice_independant", "type": "radio", "label": "Cadre d'exercice - Indépendant", "selector": "label:has-text('Indépendant Président SASU/SAS')" },

    {
      "key": "conjoint_toggle",
      "type": "toggle",
      "label": "Conjoint – Oui/Non",
      "selector": ".totem-section__header:has(.totem-section__header-title:has-text(\"Conjoint(e)\")) label[data-test=\"label\"]",
      "metadata": {
        "toggle": {
          "click_selector": ".totem-section__header:has(.totem-section__header-title:has-text(\"Conjoint(e)\")) .totem-toggle",
          "state_on_selector": ".totem-section:has(.totem-section__header-title:has-text(\"Conjoint(e)\")) .totem-toggle.totem-toggle--on"
        }
      }
    },
    { "key": "date_naissance_conjoint", "type": "text", "label": "Date naissance conjoint", "selector": "#date-naissance-conjoint input[data-test=\"input\"]" },
    {
      "key": "categorie_conjoint",
      "type": "select",
      "label": "Catégorie (conjoint)",
      "selector": ".sel-c-conjoint-content .totem-select__input input[placeholder=\"Sélectionner une catégorie socioprofessionnelle\"]",
      "options": {
        "open_selector": ".sel-c-conjoint-content .totem-select__input input[placeholder=\"Sélectionner une catégorie socioprofessionnelle\"]",
        "items": [
          { "value": "AGRICULTEURS_EXPLOITANTS", "label": "Agriculteurs exploitants", "option_selector": ".totem-select-option:has-text('Agriculteurs exploitants')" },
          { "value": "ARTISANS", "label": "Artisans", "option_selector": ".totem-select-option:has-text('Artisans')" },
          { "value": "CADRES", "label": "Cadres", "option_selector": ".totem-select-option .totem-select-option__label:text-is('Cadres')" },
          { "value": "CADRES_EMPLOYES_FONCTION_PUBLIQUE", "label": "Cadres et employés de la fonction publique", "option_selector": ".totem-select-option:has-text('Cadres et employés de la fonction publique')" },
          { "value": "CHEFS_D_ENTREPRISE", "label": "Chefs d'entreprise", "option_selector": ".totem-select-option:has-text(\"Chefs d'entreprise\")" },
          { "value": "COMMERCANTS_ET_ASSIMILES", "label": "Commerçants et assimilés", "option_selector": ".totem-select-option:has-text('Commerçants et assimilés')" },
          { "value": "EMPLOYES", "label": "Employés, agents de maîtrise", "option_selector": ".totem-select-option:has-text('Employés, agents de maîtrise')" },
          { "value": "OUVRIERS", "label": "Ouvriers", "option_selector": ".totem-select-option .totem-select-option__label:text-is('Ouvriers')" },
          { "value": "PERSONNES_SANS_ACTIVITE_PROFESSIONNELLE", "label": "Personnes sans activité professionnelle", "option_selector": ".totem-select-option:has-text('Personnes sans activité professionnelle')" },
          { "value": "PROFESSIONS_LIBERALES_ET_ASSIMILES", "label": "Professions libérales et assimilés", "option_selector": ".totem-select-option:has-text('Professions libérales et assimilés')" },
          { "value": "RETRAITES", "label": "Retraités", "option_selector": ".totem-select-option .totem-select-option__label:text-is('Retraités')" }
        ]
      }
    },
    {
      "key": "regime_conjoint",
      "type": "select",
      "label": "Régime (conjoint)",
      "selector": ".sel-c-conjoint-content .totem-select__input input[placeholder=\"Sélectionner un régime obligatoire\"]",
      "options": {
        "open_selector": ".sel-c-conjoint-content .totem-select__input input[placeholder=\"Sélectionner un régime obligatoire\"]",
        "items": [
          { "value": "ALSACE_MOSELLE", "label": "Alsace / Moselle", "option_selector": ".totem-select-option:has-text('Alsace / Moselle')" },
          { "value": "AMEXA", "label": "Amexa", "option_selector": ".totem-select-option:has-text('Amexa')" },
          { "value": "REGIME_SALARIES_AGRICOLES", "label": "Régime des salariés agricoles", "option_selector": ".totem-select-option:has-text('Régime des salariés agricoles')" },
          { "value": "SECURITE_SOCIALE", "label": "Sécurité sociale", "option_selector": ".totem-select-option:has-text('Sécurité sociale'):not(:has-text('indépendants'))" },
          { "value": "SECURITE_SOCIALE_INDEPENDANTS", "label": "Sécurité sociale des indépendants", "option_selector": ".totem-select-option:has-text('Sécurité sociale des indépendants')" }
        ]
      }
    },

    {
      "key": "enfants_toggle",
      "type": "toggle",
      "label": "Enfants – Oui/Non",
      "selector": ".totem-section__header:has(.totem-section__header-title:has-text(\"Enfants\")) label[data-test=\"label\"]",
      "metadata": {
        "toggle": {
          "click_selector": ".totem-section__header:has(.totem-section__header-title:has-text(\"Enfants\")) .totem-toggle",
          "state_on_selector": ".totem-section:has(.totem-section__header-title:has-text(\"Enfants\")) .totem-toggle.totem-toggle--on"
        }
      }
    },
    { "key": "enfants_add_button", "type": "button", "label": "Ajouter un enfant", "selector": ".totem-section:has(.totem-section__header-title:has-text(\"Enfants\")) button:has-text(\"Ajouter un enfant\")" },

    {
      "key": "date_naissance_enfant_{i}",
      "type": "text",
      "label": "Date naissance enfant {i}",
      "selector": "#date-naissance-enfant-{i} input[data-test=\"input\"]",
      "metadata": {
        "dynamicIndex": {
          "placeholder": "{i}",
          "indexBase": 0
        }
      }
    },
    {
      "key": "regime_enfant_{i}",
      "type": "select",
      "label": "Régime enfant {i}",
      "selector": ".sub-section-enfant:nth-of-type({i}) .totem-select__input input[placeholder=\"Sélectionner un régime obligatoire\"]",
      "options": {
        "open_selector": ".sub-section-enfant:nth-of-type({i}) .totem-select__input input[placeholder=\"Sélectionner un régime obligatoire\"]",
        "items": [
          { "value": "ALSACE_MOSELLE", "label": "Alsace / Moselle", "option_selector": ".totem-select-option:has-text('Alsace / Moselle')" },
          { "value": "AMEXA", "label": "Amexa", "option_selector": ".totem-select-option:has-text('Amexa')" },
          { "value": "REGIME_SALARIES_AGRICOLES", "label": "Régime des salariés agricoles", "option_selector": ".totem-select-option:has-text('Régime des salariés agricoles')" },
          { "value": "SECURITE_SOCIALE", "label": "Sécurité sociale", "option_selector": ".totem-select-option:has-text('Sécurité sociale'):not(:has-text('indépendants'))" },
          { "value": "SECURITE_SOCIALE_INDEPENDANTS", "label": "Sécurité sociale des indépendants", "option_selector": ".totem-select-option:has-text('Sécurité sociale des indépendants')" }
        ]
      },
      "metadata": {
        "dynamicIndex": {
          "placeholder": "{i}",
          "indexBase": 1
        }
      }
    }
  ]
}

